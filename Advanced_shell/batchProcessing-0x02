#!/bin/bash

# Liste des Pokémon à récupérer
POKEMONS=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Dossier de destination
DEST_DIR="pokemon_data"
mkdir -p "$DEST_DIR"

# Boucle sur chaque Pokémon
for POKEMON in "${POKEMONS[@]}"; do
    echo "Fetching data for $POKEMON..."

    # Requête curl avec gestion des erreurs
    RESPONSE=$(curl -s -w "%{http_code}" -o "$DEST_DIR/${POKEMON}.json.tmp" "https://pokeapi.co/api/v2/pokemon/$POKEMON")

    if [ "$RESPONSE" -eq 200 ]; then
        mv "$DEST_DIR/${POKEMON}.json.tmp" "$DEST_DIR/${POKEMON}.json"
        echo "Saved data to $DEST_DIR/${POKEMON}.json ✅"
    else
        echo "Failed to fetch data for $POKEMON (HTTP $RESPONSE)" | tee -a errors.txt
        rm -f "$DEST_DIR/${POKEMON}.json.tmp"
    fi

    sleep 2
done
